= gatsby-simple-blog-with-asciidoctor
:author-name: hitsuji no shippo
:!author-email:
:author: {author-name}
:!email: {author-email}
:revnumber: v1.40.0
:revdate: 2020-01-25T20:48:12+0900
:revremark: Organize section positions
:doctype: article
:description: gatsby-simple-blog-with-asciidoctor README
:title:
:title-separtor: :
:showtitle:
:!sectnums:
:sectids:
:toc: preamble
:sectlinks:
:sectanchors:
:idprefix:
:idseparator: -
:xrefstyle: full
:!example-caption:
:!figure-caption:
:!table-caption:
:!listing-caption:
ifdef::env-github[]
:caution-caption: :fire:
:important-caption: :exclamation:
:note-caption: :paperclip:
:tip-caption: :bulb:
:warning-caption: :warning:
endif::[]
ifndef::env-github[:icons: font]
// Copyright
:copyright-template: Copyright (c) 2019
:copyright: {copyright-template} {author-name}
// Page Attributes
:page-creation-date: 2019-12-03T15:47:28+0900
// Variables
:netlify-app-url: https://app.netlify.com

image:https://api.netlify.com/api/v1/badges/af30cfc5-5131-43e1-b999-287c7355114d/deploy-status[
      Netlify Status, link={netlify-app-url}/sites/lucid-bell-34419c/deploys]

:demo-url: https://lucid-bell-34419c.netlify.com
.Demo
* link:{demo-url}[Home^]
* link:{demo-url}/asciidoc-examples/[Asciidoc Examples^].

:github-url: https://github.com
:repository-url: {github-url}/hitsuji-no-shippo/gatsby-simple-blog-with-asciidoctor
image:https://www.netlify.com/img/deploy/button.svg[
      Deploy to Netlify, link={netlify-app-url}/start/deploy?repository={repository-url}]

:base-repository-link: link:{github-url}/thundermiracle/gatsby-simple-blog/tree/d8537730b37fb08a2171a29ac9c5be3d6458b0bc[ \
                            thundermiracle/gatsby-simple-blog 2019-09-14]
== Diffrences from {base-repository-link}

:gatsby-transformer-asciidoc-url: {github-url}/hitsuji-no-shippo/gatsby-transformer-asciidoc/tree/v0.12.0
:gatsby-transformer-asciidoc-link: link:{gatsby-transformer-asciidoc-url}[ \
                                        @hitsji_no_shippo/gatsby-transformer-asciidoc]
=== Change to create article from markdown to asciidoc

Create articles using asciidoc file. The files are transformed with
{gatsby-transformer-asciidoc-link}.

==== Convert value from frontmatter to attributes

.Example
[cols="2*a", options="autowidth"]
|===
|
.Before (Markdown)
[source, Markdown]
----
---
title: Show Disqus
date: "2019-06-10T22:40:32.169Z"
tags: ['2019']
disqus: true
---
----

|
.After (Asciidoc)
[source, Asciidoc]
----
= Show Disqus
:revdate: 2019-12-15T16:52:25+0900
:page-tags: ["2019"]
:page-disqus: true
----
|===

.Change fields
[cols=2, options="headers, autowidth"]
|===
|Before (Markdown)
|After (Asciidoc)

|fontmatter.date
|revision.date

|fontmatter.title
|document.title

|frontmatter.description
|document.description

|frontmatter.tags
|pageAttributes.tags


|frontmatter.disqus
|pageAttributes.disqus
|===

==== expect field delete

{gatsby-transformer-asciidoc-link} doesn't support expect.

==== Plugins

The following 7 remark plugins have been deleted.

ifdef::env-github[]
[WARNING]
====
*I'm sorry for those who read this README on GitHub because it is difficult to
read.*
====
endif::env-github[]

:asciidoctor-user-manual-url: https://asciidoctor.org/docs/user-manual
.Deleted Plugins
[cols="d,a", options="headers, autowidth"]
|===
|Name
|Alternative

2+h|Link to materials
2+h|Local materials

|gatsby-remark-copy-linked-files
|None

|gatsby-remark-images
|

.Display Images
* {asciidoctor-user-manual-url}/#images[Images]
* {asciidoctor-user-manual-url}/#setting-the-location-of-images[Setting the Location of Images]
* link:{gatsby-transformer-asciidoc-url}#set-imagesdir[
  Set imagesdir: @hitsuji_no_shippo/gatsby-transformer-asciidoc]
ifdef::env-github[]
+
--
endif::env-github[]
ifndef::env-github[]
.Example
[example]
====
endif::env-github[]
.Before (Markdown)
[source, Markdown]
----
![Chinese Salty Egg](./salty_egg.jpg)
----

.After (Asciidoc)

Image file is not automatically copied to public directory.
THerefore, it is necessary to move to public directory.

.Move image to `public/images`
[source, bash]
----
mkdir public/images
mv content/blog/hello-world/salty_egg.jpg public/images
----

.Asciidoc
[source, Asciidoc]
----
image:{imagesdir}/salty_egg.jpg[Chinese Salty Egg, link={imagesdir}/salty_egg.jpg]  // <1>
----
<1> `imagesdir` attribute values is `/images` of default value.
ifdef::env-github[]
--
+
endif::env-github[]
ifndef::env-github[]
====
endif::env-github[]

.Size & Link
* {asciidoctor-user-manual-url}/#sizing-images[Size Images]
* {asciidoctor-user-manual-url}/#summary-2[link]
+
--
.Example
[source, Asciidoc]
----
image:{url}[alt text, link={link-url}]
----
--
+

|gatsby-remark-autolink-headers
|

:auto-generated-ids-url: {asciidoctor-user-manual-url}/#auto-generated-ids
.link:{asciidoctor-user-manual-url}/#sections-summary[Sections Attributes Summary]
* link:auto-generated-ids-url[`sectids` attribute]
* link:auto-generated-ids-url[`idprefix` attribute]
* link:auto-generated-ids-url[`idseparator` attribute]
* link:{asciidoctor-user-manual-url}/#links[`sectanchors` attribute]
* link:{asciidoctor-user-manual-url}/#anchors[`sectanchors` attributes]



2+h|External materials

|gatsby-remark-external-links
|link:{asciidoctor-user-manual-url}/#link-macro-attributes[
      window attribute in link macro.]

.Macro examples
[source, Asciidoc]
----
link:{url}[display text, window=_blank]  // <1>
link:{url}[display text^]                // <2>
----
<1> specify target window
<2> Shorthand

.Example
[example]
====
.Before (Markdown)
[source, Markdown]
----
[salted duck eggs](http://en.wikipedia.org/wiki/Salted_duck_egg).
----

.After (Asciidoc)
[source, Asciidoc]
----
link:http://en.wikipedia.org/wiki/Salted_duck_egg[salted duck eggs, window=_blank]
----
====

|gatsby-remark-responsive-iframe
|link:{asciidoctor-user-manual-url}/#youtube-and-vimeo-videos[
       Youtube and vive can be embedded.]


2+h|Display text

|gatsby-remark-prismjs
|None. I want it too.

|gatsby-remark-smartypants
|None.
|===

[WARNING]
====
I don't know much about the plugins above.
Therefore, the alternative may be wrong.
====

.Change gatsby-plugin-i18n
link:{github-url}/angeloocana/gatsby-plugin-i18n/tree/master/packages/gatsby-plugin-i18n[
gatsby-plugin-i18n] doesn't support asciidoc. Therefore,it was changed to
link:{github-url}/hitsuji-no-shippo/gatsby-plugin-i18n/tree/add-support-for-other-lightweight-markup/packages/gatsby-plugin-i18n[
@hitsuji_no_shippo/gatsby-plugin-i18n] that supports Asciidoc.

==== Ignore `_includes` directory and README, CHANGELOG

The `ignore` option in link:{github-url}/gatsbyjs/gatsby/tree/master/packages/gatsby-source-filesystem[
gatsby-source-filesystem^] is used so that the next files are not generated.

.Ignore ascidoc files
* In `_includes` directory
* `README.adoc`
* `CHANGELOG.adoc`

=== Asciidoctor Support to CSS

Use this link:{github-url}/hitsuji-no-shippo/article-css-for-asciidoc/tree/30575534810dc487b6df82ba755943863340a271[
git repository^].

=== Link to edit article on GitHub

You can add link to edit on GitHub into article footer. To add a link,
you need to set `repository` and `articles` in `config/index.js`.
The link is not displayed in the following cases.

.Cases
* `articles.dir` is `undefined`.
* Field of `articles.filePath` doesn't exist.
* `articles.isOtherRepositroy` is `false` and
  `repository.url` is `undefined`.
* Match with `articles.ignore` option.

==== How to make url

.Articles is other repository (submodule)
[source, JavaScript]
----
articles: {
  dir: 'hitsuji-no-shippo/sample-articles-for-asciidoctor',  // <1>
  isOtherRepositroy: true
  filePath: { Asciidoc: 'paths.from.source.full' },
}
----
<1> Repositroy name in GitHub.

[CAUTION]
====
Nested submodules are not supported.
====

.Articles is same repository
[source, JavaScript]
----
articles: {
  dir: 'content/blog',  // <1>
  isOtherRepositroy: false
  filePath: { Asciidoc: 'paths.from.source.full' },
}
----
<1> Articles directory path from gatsby project root.

.url
[cols="m,2*d", options="headers, autowidth]
|===
|isOtherRepositroy
|URL to articles directory
|Mutual

|true
|{github-url}

.2+|/${articles.dir}/edit/master/${node[filePath]}

|false
|${repository.url}
|===

==== `filePath`

After the `master/`, the field value of `filePath` in node follows.
The Key is `node.internal.type` value, value is field of file path.
For `Asciidoc: 'paths.from.source.full'`, Asciidoc node uses the value of
`node.paths.from.source.full`.
If field of `filePath` doesn't exist, not add link and no error occurs.

[NOTE]
====
`node.paths.from.source` is maked link:{gatsby-transformer-asciidoc-url}#how-to-query[
gatsby-transformer-asciidoc^].
====

==== `ignore`

No link is added to the article with the path(field value of `filePath`) that
glob matches at least one `articles.ignore`.

.example
[source, JavaScript]
----
articles: {
  dir: 'hitsuji-no-shippo/sample-articles-for-asciidoctor',
  ignore: ['asciidoc-examples/**/*.adoc'],
}
----

=== Links in Bio

.Change points
* From icon to text.
* Add rss(`/rss.xml`).
* Config From `siteMetadata` to `linksInBio` in `config/index.js`.
+
--
.Example
[source, JavaScript, subs="attributes"]
----
{
  twitter: 'https://twitter.com/hns_equal_st',     // <1>
  GitHub: '{github-url}/hitsuji-no-shippo',  // <1>
}
----
<1> key (`twitter`) is dispaly text, value (`https...`) is url.
--

=== Author Config

Change value of the author name from `site.author` to `author.name` in
`config/index.js`. The `authro` values are used as the default attributes in
Asciidoc.

[cols=4, options="headers, autowidht"]
|============================================================
|Key           |siteMetadata   |Asciidoc Attribute  |Required
|name          |author         |author              |Yes
|email         |Not use        |email               |No
|url           |Not use        |page-author-url     |No
|twitter       |social.twitter |page-author-twitter |No
|shouldDisplay |Not use        |Not use             |No
|============================================================

:attributes-priority-description-link: link:{asciidoctor-user-manual-url}/#altering-the-attribute-assignment-precedence[ \
                                            Page attributes take precedence^]
[NOTE]
====
.{attributes-priority-description-link}
Page attributes take precedence because `@` is added to the end of the
default asciidco attributes.
====

=== Profile Picture Link

Add link to the profile picture in Bio.
Used value of url is `author.url` in `config/index.js`.
If you do not want to add a link, set `author.url` to `null`.

=== Article Author Display

Dispaly article author under article title. By default, if the article author
name is the same as `author.name` in `config/index.js`,
it will not be displayed. If you want to display it,
set `author.shouldDisplay` in `config/index.js` to `true`.

==== Link

.The article author is the blog author.
If the `author.url` exist, will be a link.

.The article author is not the blog author.
If the `page-author-url` or `page-author-twitter` of asciidoc attributes exists,
will be a link.

.How to make href (Y: exist N: not exist)
|==========================================================
|twitter|url    |href
|N      |N      |Not link
|Y      |N     m|\https://twitter.com/@{page-author-twitter}
|N      |Y   .2+|page-author-url
|Y      |Y
|==========================================================


=== Date Display

Date display is determined by `dateDisplay` in `config/index.js`.

.`dateDisplay`
[source, Vim]
----
const dateDisplay = {
  format: "LL",  // <1>
  diff: {
    patternWithNotConvert: /month|year/,  // <2>
    newPost: {
      boundary: 7,  // <3>
      emoji: '🎉',  // <4>
    },
  },
}
----
:moment-token-url: link:https://momentjs.com/docs/#/parsing/string-format/[ \
                        token]
<1> String using {moment-token-url}.
    In the case of `LL`, the date dispaly is as follows:
+
--
[horizontal]
English:: *January 22, 2020*
日本語 :: *2020年1月21日*
--
<2> Pattern not converted to date difference (e.g *a day ago*, *1日前* ).
    In the case of `/month|year/`, date dispaly is converted as follows:
+
--
.Now is January 22, 2020
[horizontal]
January  20, 2020:: 2 days ago
December  2, 2019:: December  2, 2019
January  20, 2019:: January  20, 2019
--
<3> Boundary days to determine if it is a new post.
    In the case of `7`, it is determined as follows.
+
--
[cols=2, options="headers, autowidth"]
|===================
|Difficult      |New
|an hour ago .4+|Yes
|a day ago
|2 days ago
|7 days ago
|8 days ago     |No
|==================

--
+
[CAUTION]
====
Possible values are 1 to 25.
====
<4> Emoji to be added to the beginning of new post date.

=== Disqus

.Change default from non dispaly to dispaly
By default, dispaly disqus in article pages. If the value of asciidoc attribute
`page-disqus` is `false`, non dispaly.

.Add comment count link
Displayed next to read to time. Click to go to embedded disqus of the article.

=== Tags Link

Add link to tag list next to count posts in index.

=== Scroll Up

Add Scroll Up at bottom right.

=== HOME Link

Add home link between relative posts in article page.

=== Tag List position

Change position in index to under the line starting from update date.

=== Repository link in Footer

Used `repository` in `config/index.js`
Doesn't displays link, if `url` is `undefined` or `displaysLink` is `false`.

.Default values
[horizontal]
url         :: {repository-url}
name        :: gatsby-simple-blog-with-asciidoctor
displaysLink:: true

=== Change element of blog entry

Change to
link:https://developer.mozilla.org/en-US/docs/Web/HTML/Element/article[
`article`]

=== SEO

* Add `twitter:site`. The value (twitter id) used is
  `siteMetadata.social.twitter`
* Add `og:url`. The value used is `siteMetadata.siteUrl` + `node.fields.slug`
* The value used in `twitter: creator` has been changed to
  `page-author-twitter` asciidoc attribute.
+
--
[NOTE]
====
.Cases where `twitter: creator` is not created.
* The `page-author-twitter` asciidoc attribute isn't exist.
* The `author` attribute is different from the `siteMetadata.author` and
  the `page-author-twitter` attribute value is the same as
  `siteMetadata.social.twitter`.
====
--
+


== Description

A gatsbyjs starter forked from gatsby-starter-blog and applied overreacted
lookings, with tags and breadcrumbs, eslint, relative posts, disqus, i18n,
eslint supported.

== How to use

[source, bash]
----
npm install -g gatsby-cli

gatsby new my-blog-folder {github-url}/hitsuji-no-shippo/gatsby-simple-blog-with-asciidoctor
cd my-blog-folder
----

== How to deploy by Circle-CI in Medium.com

link:https://medium.com/@thundermiracle/deploy-static-sites-to-netlify-by-circle-ci-ab51a0b59b73?source=friends_link&sk=095db82e2f8e8ef91d03a171f217e340[
Medium.com -- Deploy Static Sites to Netlify by Circle-CI]

== Configuration

All configurable values are here: `./config/index.js`

== i18n

. Add [lang].js to config/locales folder
. Modify supportedLanguages in config/index.js
. Set site.lang in config/index.js as default language
. add [filename].[lang].md to content/blog and enjoy!

== Features

* i18n
+
--
Display multiple language. (Only be shown when supportedLanguages > 1)

Display language link in every post.
(You can disable it in config/index.js by displayTranslations: false)
--
+
* overreacted design +
  link:https://overreacted.io/[
  overreacted.io] lookings
* Tags +
  Display articles in same tag.
* Breadcrumbs +
Display breadcrumbs in header part.
* Relative posts +
Display previous and next posts in same tag in footer part.
* Disqus +
Use disqus.com to enable comment.
* eslint +
  Enable eslint for better coding experience.
* module resolver +
  Enable babel-module-resolver to prevent relative path hell

== LICENSE

=== This project

This project is licensed under the terms of the link:/LICENSE[MIT license].

=== Materials used

:cc0-10-link: link:https://creativecommons.org/publicdomain/zero/1.0[CC0 1.0]
:font-awesome-github-repo-url: {github-url}/FortAwesome/Font-Awesome
:dova-s-url: https://dova-s.jp
:evericons-url: http://www.evericons.com
[cols="d,d,a", options="headers, autowidth"]
|===
|Material
|LICENSE
|path

|link:https://visualhunt.com/photo2/170504/[
      Profile picture]
|{cc0-10-link}
|`content/assets/profile-pic.jpg`

|link:{evericons-url}[
      Language icon]
|{cc0-10-link}
|`src/components/LangButton/IconLanguage.js`

|link:{evericons-url}[
      Theme icons]
|{cc0-10-link}
|
 * `src/components/Layout/ReadModeToggle/IconSun.js`
 * `src/components/Layout/ReadModeToggle/IconMoon.js`

Resized from 24x24 to 16x16.
|link:{evericons-url}[
      Scroll up icon]
|{cc0-10-link}
|`src/components/Layout/ScrollUp.js`

|link:{font-awesome-github-repo-url}[
      Admonition icons]
|link:{font-awesome-github-repo-url}/#license[
      CC BY 4.0 License]
|link:{font-awesome-github-repo-url}[
      FortAwesome/Font-Awesome]

|link:{dova-s-url}/bgm/play5513.html[
      Moon La]
|link:{dova-s-url}/_contents/license/[
      SOUND LICENSE]
|`static/audios/moon_la.mp3`
|===
